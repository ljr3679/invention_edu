<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://www.mybatis.org/dtd/mybatis-3-mapper.dtd"> 
 
<mapper namespace="HomeKorAdminMemberMngTeacher_SQL">

	<select id="HomeKorAdminMemberMngTeacher_SQL.selectTeacherDataList" parameterType="vo" resultType="egovMap">
	/* HomeKorAdminMemberMngTeacher_SQL.selectTeacherDataList */
	SELECT
			Z.*
		FROM
			(
				SELECT
					ROWNUM AS RNUM,
					X.*
				FROM
					(
						SELECT 
							T1.tb_teacher_pool_seq AS no,
							T1.member_id,
							T1.member_name,
							T1.department,
							T1.department_position,
							T1.birth,
							T1.gender,
							T1.phone,
							T1.email,
							TO_CHAR(T1.create_date,'YYYY-MM-DD') AS create_date,
							T2.privacy_yn,
							T2.crims_yn
						FROM 
							tb_teacher_pool T1
						left join tb_teacher_agree T2 on t1.member_id = t2.member_id 							
						<where>
							<if test='searchKeyword != ""'>
								<choose>
									<when test='searchValue1 == "0"'>
								AND
								(
											T1.member_id														LIKE '%' || #{searchKeyword} || '%'
								OR			T1.member_name														LIKE '%' || #{searchKeyword} || '%'
								)
									</when>
									<when test='searchValue1 == "1"'>
								AND			T1.member_id														LIKE '%' || #{searchKeyword} || '%'
									</when>
									<when test='searchValue1 == "2"'>
								AND			T1.member_name														LIKE '%' || #{searchKeyword} || '%'
									</when>
								</choose>
							</if>
						</where>
						ORDER BY T1.tb_teacher_pool_seq DESC
					) X
		) Z
		<where>
		<![CDATA[ AND Z.RNUM > #{firstIndex} AND ROWNUM <= #{recordCountPerPage} ]]>
		</where>
	</select>

	<select id="HomeKorAdminMemberMngTeacher_SQL.selectTeacherExlDataList" parameterType="vo" resultType="egovMap">
	/* HomeKorAdminMemberMngTeacher_SQL.selectTeacherExlDataList */

		SELECT 
			T1.tb_teacher_pool_seq AS no,
			T1.member_id,
			T1.member_name,
			T1.department,
			T1.department_position,
			T1.acq_at,
			T1.class_history,
			T1.birth,
			T1.gender,
			T1.phone,
			T1.email,
			TO_CHAR(T1.create_date,'YYYY-MM-DD') AS create_date,
			T2.privacy_yn,
			T2.crims_yn
		FROM 
			tb_teacher_pool T1
		left join tb_teacher_agree T2 on t1.member_id = t2.member_id 							
		<where>
			<if test='searchKeyword != ""'>
				<choose>
					<when test='searchValue1 == "0"'>
				AND
				(
							T1.member_id														LIKE '%' || #{searchKeyword} || '%'
				OR			T1.member_name														LIKE '%' || #{searchKeyword} || '%'
				)
					</when>
					<when test='searchValue1 == "1"'>
				AND			T1.member_id														LIKE '%' || #{searchKeyword} || '%'
					</when>
					<when test='searchValue1 == "2"'>
				AND			T1.member_name														LIKE '%' || #{searchKeyword} || '%'
					</when>
				</choose>
			</if>
		</where>
		ORDER BY T1.tb_teacher_pool_seq DESC

	</select>

	
	<select id="HomeKorAdminMemberMngTeacher_SQL.selectTeacherDataListCnt" parameterType="vo" resultType="int">
	/* HomeKorAdminMemberMngTeacher_SQL.selectTeacherDataListCnt */
		SELECT 
			COUNT(1)
		FROM 
			tb_teacher_pool T1
			<where>
				<if test='searchKeyword != ""'>
					<choose>
						<when test='searchValue1 == "0"'>
					AND
					(
								T1.member_id														LIKE '%' || #{searchKeyword} || '%'
					OR			T1.member_name														LIKE '%' || #{searchKeyword} || '%'
					)
						</when>
						<when test='searchValue1 == "1"'>
					AND			T1.member_id														LIKE '%' || #{searchKeyword} || '%'
						</when>
						<when test='searchValue1 == "2"'>
					AND			T1.member_name														LIKE '%' || #{searchKeyword} || '%'
						</when>
					</choose>
				</if>
			</where>
	</select>
	
	 <select id="HomeKorAdminMemberMngTeacher_SQL.selectTeacherData" parameterType="vo" resultType="egovMap">
	/* HomeKorAdminMemberMngTeacher_SQL.selectTeacherData */
		SELECT
				T1.tb_teacher_pool_seq AS no,
				T1.member_id,
				T1.member_name,
				T1.birth,
				T1.gender,
				T1.phone,
				T1.email,
				T1.department,
				T1.department_position,
				T1.acq_at,
				T1.acq_auth_num,
				T1.research_group_history,
				T1.job_training_history,
				T1.kipa_edu_career,
				T1.etc_career,
				T1.advice_school_type,
				T1.create_date,
				T1.mod_date,
				T1.exit_date,
				T1.modifyer,
				T1.class_history
		FROM 	
				tb_teacher_pool T1
		<where>
		AND			T1.tb_teacher_pool_seq							= #{idx}
		</where>
	</select>
	
	<select id="HomeKorAdminMemberMngTeacher_SQL.selectTeacherSubEduInfoList" parameterType="str" resultType="egovMap">
		/* selectTeacherPoolSubEduInfoList */
		SELECT
				T1.tb_teacher_edu_pool_seq,
				T1.teacher_pool_ref,
				T1.level,
				T1.year,
				T1.major,
				T1.sort,
				T1.create_date	
		FROM
				tb_teacher_edu_pool T1
		WHERE
				T1.teacher_pool_ref = #{idx}
	</select>	

	<select id="HomeKorAdminMemberMngTeacher_SQL.selectTeacherSubCareerInfoList" parameterType="str" resultType="egovMap">
		/* selectTeacherPoolSubCareerInfoList */
		SELECT
				T1.tb_teacher_career_pool_seq,
				T1.teacher_pool_ref,
				T1.year,
				T1.program,
				T1.turn,
				T1.sort,
				T1.create_date	
		FROM
				tb_teacher_career_pool T1
		WHERE
				T1.teacher_pool_ref = #{idx}
	</select>

	<insert id="HomeKorAdminMemberMngTeacher_SQL.insertTeacherData" parameterType="vo">
		<selectKey resultType="vo" keyProperty="idx" order="BEFORE">
			SELECT NVL(MAX(TB_TEACHER_POOL_SEQ), 0) + 1 AS idx FROM tb_teacher_pool
		</selectKey>	
		/* insertTbTeacherData */
		INSERT INTO tb_teacher_pool (
			TB_TEACHER_POOL_SEQ,
			MEMBER_ID,
			MEMBER_NAME,
			BIRTH,
			GENDER,
			PHONE,
			EMAIL,
			DEPARTMENT,
			DEPARTMENT_POSITION,
			ACQ_AT,
			ACQ_AUTH_NUM,
			RESEARCH_GROUP_HISTORY,
			JOB_TRAINING_HISTORY,
			KIPA_EDU_CAREER,
			ETC_CAREER,
			ADVICE_SCHOOL_TYPE,
			CREATE_DATE,
			MOD_DATE,
			EXIT_DATE,
			MODIFYER,
			CLASS_HISTORY
		) VALUES (
			#{idx},
			#{paramKey2},
			#{paramKey3},
			#{paramKey4},
			#{paramKey5},
			#{paramKey6},
			#{paramKey7},
			#{paramKey8},
			#{paramKey9},
			#{paramKey10},
			#{paramKey11},
			#{paramKey14},
			#{paramKey15},
			#{paramKey16},
			#{paramKey17},
			#{paramKey18},
			now(),
			current_date,
			current_date,
			'',
			#{paramKey19}
		)
	</insert>

	<insert id="HomeKorAdminMemberMngTeacher_SQL.insertTbTeacherEduData" parameterType="vo">
		<selectKey resultType="vo" keyProperty="idx" order="BEFORE">
			SELECT NVL(MAX(TB_TEACHER_EDU_POOL_SEQ), 0) + 1 AS idx FROM tb_teacher_edu_pool
		</selectKey>	
		/* insertTbTeacherEduData */
		INSERT INTO tb_teacher_edu_pool(
			TB_TEACHER_EDU_POOL_SEQ,
			TEACHER_POOL_REF,
			LEVEL,
			YEAR,
			MAJOR,
			SORT,
			CREATE_DATE			
		)VALUES(
			#{idx},
			#{paramKey1},
			#{paramKey32},
			#{paramKey33},
			#{paramKey34},
			#{paramKey41},
			current_date			
		)
	</insert>

	<insert id="HomeKorAdminMemberMngTeacher_SQL.insertTbTeacherCareerData" parameterType="vo">
		<selectKey resultType="vo" keyProperty="idx" order="BEFORE">
			SELECT NVL(MAX(TB_TEACHER_CAREER_POOL_SEQ), 0) + 1 AS idx FROM tb_teacher_career_pool
		</selectKey>	
		/* insertTbTeacherCareerData */
		
		INSERT INTO tb_teacher_career_pool(
			TB_TEACHER_CAREER_POOL_SEQ,
			TEACHER_POOL_REF,
			YEAR,
			PROGRAM,
			TURN,
			SORT,
			CREATE_DATE			
		)VALUES(
			#{idx},
			#{paramKey1},
			#{paramKey35},
			#{paramKey36},
			#{paramKey37},
			#{paramKey42},
			current_date			
		)
	</insert>


	<update id="HomeKorAdminMemberMngTeacher_SQL.updateTbTeacherData" parameterType="vo">
		/* updateTbTeacherData */
		UPDATE tb_teacher_pool set
			birth					=	#{paramKey4},
			gender					=	#{paramKey5},
			phone					=	#{paramKey6},
			email					=	#{paramKey7},
			department				=	#{paramKey8},
			department_position		=	#{paramKey9},
			acq_at					=	#{paramKey10},
			acq_auth_num			=	#{paramKey11},
			research_group_history	=	#{paramKey14},
			job_training_history	=	#{paramKey15},
			kipa_edu_career			=	#{paramKey16},
			etc_career				=	#{paramKey17},
			advice_school_type		=	#{paramKey18},
			mod_date				= now(),
			class_history			=	#{paramKey19}
	WHERE
			TB_TEACHER_POOL_SEQ = #{paramKey1}
	</update>

	<delete id="HomeKorAdminMemberMngTeacher_SQL.deleteTeacherData" parameterType="vo">
	/* deleteTeacherData */
		UPDATE tb_teacher_pool set
		mod_date				= now()
		<where>
		AND			tb_teacher_pool_seq																= #{paramKey1}
		</where>
	</delete>
	
	<delete id="HomeKorAdminMemberMngTeacher_SQL.deleteTeacherCareerData" parameterType="vo">
	/* deleteHomeKorAdminUrl */
		DELETE FROM tb_teacher_career_pool
		<where>
		AND			teacher_pool_ref															= #{paramKey1}
		</where>
	</delete>
	
	<delete id="HomeKorAdminMemberMngTeacher_SQL.deleteTeacherEduData" parameterType="vo">
	/* deleteHomeKorAdminUrl */
		DELETE FROM tb_teacher_edu_pool
		<where>
		AND			teacher_pool_ref															= #{paramKey1}
		</where>
	</delete>		


	
</mapper>
